# `select-posh-theme.sh` ‚ú®

This Bash script provides a convenient way to manage and preview your Oh My Posh themes using Rofi. It allows you to quickly switch between your locally installed themes or browse image previews fetched from the Oh My Posh documentation website (via a separate scraper script). It uses the `loupe` image viewer to display previews and `ex` to modify your fish configuration.

## Features üöÄ

* Displays a Rofi menu listing your installed Oh My Posh themes.

* Allows you to select a theme to apply it to your fish shell configuration by modifying `~/.config/fish/config.fish` using the `ex` command.

* Provides an option to browse theme preview images from a local JSON file (generated by `scrape-posh-previews.sh`), displayed using `loupe`. The Rofi menu for previews shows theme names instead of full URLs.

* Offers an option to open the selected theme's section on the official Oh My Posh documentation website using `xdg-open`.

## Requirements üõ†Ô∏è

This script requires the following to be installed and configured on your system:

* **`bash`**: The shell to execute the script (standard on most Linux systems).

* **`rofi`**: A window switcher, application launcher, and dmenu replacement.

  * Installation (Arch Linux):

    ```bash
    sudo pacman -S rofi
    ```

* **`jq`**: A lightweight and flexible command-line JSON processor (needed for browsing local previews).

  * Installation (Arch Linux):

    ```bash
    sudo pacman -S jq
    ```

* **`loupe`**: The GNOME Image Viewer (used to display image previews from URLs). This is often pre-installed on systems using the GNOME desktop environment.

  * Installation (Arch Linux):

    ```bash
    sudo pacman -S loupe # if not already installed
    ```

* **`ex`**: A standard line editor used non-interactively for file modification (usually part of `vim` or `vi` packages, standard on most Linux systems).

* **`xdg-open`**: A utility to open files or URLs in the user's preferred application (used for opening documentation links, usually part of `xdg-utils`).

  * Installation (Arch Linux):

    ```bash
    sudo pacman -S xdg-utils
    ```

* **Oh My Posh**: The prompt theme engine itself.

  * Refer to the [Oh My Posh installation guide](https://ohmyposh.dev/docs/installation/linux) for installation instructions.

* **Installed Oh My Posh Themes**: Theme files (`.omp.json`) located in the directory specified by the `THEMES_DIR` variable in the script (defaults to `~/.poshthemes`).

* **(Optional, for local previews) `scrape-posh-previews.sh` script and `theme_previews.json` file**: The scraper script to generate the local JSON file containing image URLs.

  * Refer to the [README for `scrape-posh-previews.sh`](../scrape-posh-previews/README.md) for details on this script.

## Installation ‚¨áÔ∏è

1. **Save the script:** Copy the content of the `select-posh-theme.sh` script into a file named `select-posh-theme.sh`.

2. **Choose an installation directory:** Save this file to a directory that is included in your system's `PATH` environment variable. A standard location for user-specific scripts is `~/.local/bin/`, but you can choose any directory in your `PATH`. Let's refer to your chosen directory as `YOUR_SCRIPT_DIR`.

   ```bash
   mkdir -p YOUR_SCRIPT_DIR
   # Then save the script content to YOUR_SCRIPT_DIR/select-posh-theme.sh
   ```
   *Replace `YOUR_SCRIPT_DIR` with the actual path you choose.*

3. **Make it executable:** Give the script execute permissions.

   ```bash
   chmod +x YOUR_SCRIPT_DIR/select-posh-theme.sh
   ```
   *Replace `YOUR_SCRIPT_DIR` with the actual path you choose.*

4. **Verify PATH:** Ensure `YOUR_SCRIPT_DIR` is in your `PATH`. You can check with `echo $PATH`. If it's not, add the directory to your `PATH` in your shell configuration file (e.g., add `fish_add_path YOUR_SCRIPT_DIR` to your `~/.config/fish/config.fish` for fish shell) and restart your terminal.

## Usage üñ±Ô∏è

To run the theme switcher script, simply open your terminal and execute it by name:

```bash
select-posh-theme.sh
```

A Rofi menu will appear with the following options:

1.  **Installed Themes:** A list of `.omp.json` files found in your themes directory. Selecting a theme name will present a second menu with options to "Apply Theme" or "Show Documentation Section".

2.  **Browse Local Previews:** (Appears if `jq` and `loupe` are installed and `theme_previews.json` exists) Selecting this option will display a second Rofi menu listing **theme names**. Selecting a theme name will open its corresponding image preview using `loupe`.
3.  **Generate Local Previews (Run Scraper):** (Appears if `jq` is installed but `loupe` or `theme_previews.json` does not exist) Selecting this option will execute the `scrape-posh-previews.sh` script to generate the local preview file. You will then need to run `select-posh-theme.sh` again to browse the previews.

**Applying a Theme:**

If you select a theme and choose "Apply Theme", the script will modify your `~/.config/fish/config.fish` file using the `ex` command to update the `oh-my-posh init fish --config ... | source` line to point to the selected theme file.

**Note:** For the theme change to take effect, you must open a **new terminal session** or manually `source ~/.config/fish/config.fish` in your current terminal.

## Integration ü§ù

This script works in conjunction with the `scrape-posh-previews.sh` script. The scraper script is responsible for fetching and maintaining the local `theme_previews.json` file that this switcher script reads from for the "Browse Local Previews" feature.

---

This README provides a comprehensive overview of the `select-posh-theme.sh` script.
